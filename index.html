<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GoBuy Nepal — Customer Login</title>
  <meta name="description" content="GoBuy Nepal: Buy worldwide, deliver to Nepal." />
  <style>
    :root{
      --red:#E53935; --blue:#1E3A8A; --ink:#1f2033; --muted:#7e8190; --line:#e6e7ef;
      --bg:#f7f7fb; --card:#fff; --radius:14px; --shadow:0 12px 24px rgba(27,31,35,.06);
      --fb:#1877F2; --apple:#000; --google:#fff;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    a{color:inherit;text-decoration:none}

    /* Top bar */
    .topbar{position:sticky; top:0; z-index:10; background:#fff; border-bottom:1px solid var(--line)}
    .topbar__inner{height:60px; max-width:1100px; margin:0 auto; padding:0 16px;
      display:flex; align-items:center; justify-content:space-between; gap:12px}
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px}
    .brand img{width:32px; height:32px; object-fit:contain}

    /* Right-top buttons */
    .actions{display:flex; align-items:center; gap:8px; margin-left:auto}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:6px 10px; font-size:13px; font-weight:600; border-radius:10px; border:1px solid var(--line);
      transition:transform .04s ease, background .2s ease, color .2s ease, border-color .2s ease; white-space:nowrap; line-height:1; cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .btn--ghost{background:#fff; color:var(--blue)}
    .btn--ghost:hover{background:#f2f4ff; border-color:#d9defa}
    .btn--solid{background:var(--blue); color:#fff; border-color:var(--blue)}
    .btn--solid:hover{filter:brightness(1.05)}
    .btn--primary{background:var(--blue); color:#fff; border:1px solid var(--blue); padding:10px 14px; border-radius:12px; font-weight:700}
    .full{width:100%}

    /* Layout */
    .wrap{max-width:1100px; margin:28px auto; padding:0 16px}
    .grid{display:grid; grid-template-columns:1.2fr 1fr; gap:24px}
    .card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); padding:20px}
    .title{font-size:28px; font-weight:800; margin:0 0 6px}
    .muted{color:var(--muted)}
    .center{display:flex; align-items:center; gap:10px}
    @media (max-width:900px){ .grid{grid-template-columns:1fr} }

    /* Login form */
    .login-head{display:flex; align-items:center; gap:12px; margin-bottom:8px}
    .login-logo{width:42px; height:42px; object-fit:contain}
    .input{width:100%; border:1px solid var(--line); border-radius:12px; padding:12px; outline:none}
    .input:focus{border-color:#cbd3ff; box-shadow:0 0 0 3px rgba(30,58,138,.08)}
    .field{margin-bottom:12px}
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .hint{font-size:12px; color:var(--muted)}
    .error{background:#fff3f3; color:#b00020; border:1px solid #ffd3d3; padding:10px; border-radius:10px; margin-bottom:12px; display:none}

    /* Social buttons */
    .social{display:flex; flex-direction:column; gap:10px; margin-bottom:14px}
    .sbtn{display:flex; align-items:center; gap:10px; border-radius:12px; padding:10px 12px; border:1px solid var(--line); cursor:pointer; justify-content:center; font-weight:700}
    .sbtn svg{width:18px; height:18px}
    .sbtn--google{background:var(--google)}
    .sbtn--apple{background:var(--apple); color:#fff; border-color:var(--apple)}
    .sbtn--facebook{background:var(--fb); color:#fff; border-color:var(--fb)}
    .divider{display:flex; align-items:center; gap:10px; margin:6px 0 12px}
    .divider span{height:1px; background:var(--line); flex:1}
  </style>
</head>
<body>
  <!-- Top navigation with right-top buttons -->
  <header class="topbar">
    <div class="topbar__inner">
      <a class="brand" href="index.html" aria-label="GoBuy Nepal Home">
        <img src="assets/icons/gobuynepal-logo.png" alt="GoBuy Nepal logo"/>
        <span>GoBuy Nepal</span>
      </a>

      <nav class="actions" aria-label="Quick logins">
        <a class="btn btn--ghost" href="vendor-login.html" title="Vendor Login">Vendor Login</a>
        <a class="btn btn--solid" href="admin-login.html" title="Admin Login">Admin Login</a>
      </nav>
    </div>
  </header>

  <!-- Body -->
  <main class="wrap">
    <div class="grid">
      <!-- Left: Hero / info -->
      <section class="card">
        <div class="center">
          <img src="assets/icons/1.png" alt="GoBuy Nepal" style="width:180px; height:145px;"/>
          <div>
            <hr style=" color:#7a1ea1; font-size:22px; margin:10px 0 24px;"/>
            <h1 class="title">Bringing World To Your Doorstep</h1>
            <p class="muted">Import/Export, order tracking, secure payments, and local delivery—simple and transparent.</p>
          </div>
        </div>
        <hr style="margin:16px 0; border:none; border-top:1px solid var(--line)" />
        <ul class="muted">
          <li>✅ Shop from top global stores</li>
          <li>✅ Fast & reliable delivery</li>
          <li>✅ Secure online payments</li>
        </ul>
      </section>

      <!-- Right: Customer Login -->
      <section class="card">
        <div class="login-head">
          <img class="login-logo" src="assets/icons/gobuynepal-logo.png" alt="GoBuy Nepal"/>
          <div>
            <h2 style="margin:0; font-size:20px; font-weight:800">Customer Login</h2>
            <div class="hint">Choose a provider or continue with email.</div>
          </div>
        </div>

        <!-- Social buttons -->
        <div class="social">
          <button class="sbtn sbtn--google" onclick="oauth('google')">
            <svg viewBox="0 0 48 48" aria-hidden="true"><path fill="#FFC107" d="M43.6 20.5H42V20H24v8h11.3C33.7 33.7 29.3 36 24 36c-6.6 0-12.2-4.3-14.2-10.2S8 13.6 14 10.6 27.8 8.1 33.5 13l5.7-5.7C34 2.9 27.2 0 20 0 8.9 0 0 8.9 0 20s8.9 20 20 20c12 0 19.9-8.4 19.9-20 0-1.3-.2-2.6-.4-3.8z"/><path fill="#FF3D00" d="M6.5 14.6l6.6 4.8C14.5 15 17 12 20 12c3 0 5.6 2 6.6 4.8l6.6-4.8C30.5 4.7 25.6 2 20 2 12.9 2 7 6.3 4.5 12.6z"/><path fill="#4CAF50" d="M20 38c5.5 0 10.2-1.8 13.5-5l-6.3-4.9C25.7 29 22.9 30 20 30c-3 0-5.6-2-6.6-4.8l-6.6 4.9C7.4 34.5 13 38 20 38z"/><path fill="#1976D2" d="M43.6 20.5H42V20H24v8h11.3c-1.7 3.2-5.1 6-11.3 6-6.7 0-12.3-4.3-14.2-10.2L3.9 28.7C6.9 35.7 13 40 20 40c12 0 20-8.4 20-20 0-1.3-.2-2.6-.4-3.8z"/></svg>
            Continue with Google
          </button>

          <button class="sbtn sbtn--apple" onclick="oauth('apple')">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#fff" d="M16.365 1.43c0 1.14-.467 2.207-1.221 3-.777.82-2.07 1.45-3.138 1.364-.131-1.156.503-2.314 1.243-3.063.806-.813 2.185-1.42 3.116-1.3zM21.5 17.03c-.584 1.32-1.29 2.63-2.324 3.99-1.003 1.316-2.27 2.965-3.936 2.98-1.652.016-2.176-.96-4.04-.96-1.864 0-2.443.93-4.072.976-1.668.046-2.936-1.42-3.94-2.735C1.38 19.9.354 17.34.19 14.89c-.046-1.064.19-2.11.706-3.05.78-1.39 2.168-2.265 3.697-2.28 1.633-.03 2.972 1.06 3.958 1.06.973 0 2.643-1.31 4.46-1.12.759.03 2.88.306 4.241 2.3-.11.066-2.535 1.48-2.513 4.41.03 3.52 3.07 4.69 3.06 4.7z"/></svg>
            Continue with Apple
          </button>

          <button class="sbtn sbtn--facebook" onclick="oauth('facebook')">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#fff" d="M22 12.07C22 6.5 17.52 2 12 2S2 6.5 2 12.07C2 17.08 5.66 21.2 10.44 22v-7.02H7.9v-2.9h2.54V9.41c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.22.2 2.22.2v2.44h-1.25c-1.23 0-1.62.77-1.62 1.56v1.87h2.76l-.44 2.9h-2.32V22C18.34 21.2 22 17.08 22 12.07z"/></svg>
            Continue with Facebook
          </button>
        </div>

        <div class="divider"><span></span><small class="muted">or</small><span></span></div>

        <div id="err" class="error"></div>

        <form id="loginForm" novalidate>
          <div class="field">
            <label for="email" class="hint" style="display:block; margin-bottom:6px">Email</label>
            <input id="email" class="input" type="email" placeholder="you@example.com" autocomplete="username" required />
          </div>

          <div class="field">
            <div class="row" style="margin-bottom:6px">
              <label for="password" class="hint">Password</label>
              <button id="togglePw" type="button" class="btn" style="padding:4px 8px; font-weight:600">Show</button>
            </div>
            <input id="password" class="input" type="password" placeholder="••••••••" autocomplete="current-password" required />
          </div>

          <div class="row" style="margin:10px 0 16px">
            <label style="display:flex; align-items:center; gap:8px; font-size:13px; color:var(--muted)">
              <input id="remember" type="checkbox" /> Remember me
            </label>
            <a class="hint" href="forgot-password.html">Forgot password?</a>
          </div>

          <button id="emailSubmit" class="btn--primary full" type="submit">Continue with Email</button>

          <p class="hint" style="text-align:center; margin-top:12px">
            New user? <a href="signup.html" style="color:var(--blue); font-weight:700">Create an account</a>
          </p>
        </form>
      </section>
    </div>
  </main>

  <!-- ==== Firebase Auth (Email + Google/Apple/Facebook) ==== -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
      getAuth, setPersistence, browserLocalPersistence, browserSessionPersistence,
      signInWithEmailAndPassword, signInWithPopup, signInWithRedirect,
      GoogleAuthProvider, FacebookAuthProvider, OAuthProvider
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

    // Your Firebase project config
    const firebaseConfig = {
      apiKey: "AIzaSyC5BOwwDRg46t2LmWp-z8gOXEoyATioSQM",
      authDomain: "customer-login-e5ecd.firebaseapp.com",
      projectId: "customer-login-e5ecd",
      storageBucket: "customer-login-e5ecd.appspot.com",
      messagingSenderId: "569269085839",
      appId: "1:569269085839:web:0192c9f28b8eb24ea2f2fa"
    };

    // Redirect after successful login
    const AFTER_LOGIN_REDIRECT = 'home.html';

    // Init
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // DOM
    const $ = s => document.querySelector(s);
    const errBox   = $('#err');
    const form     = $('#loginForm');
    const emailEl  = $('#email');
    const pwEl     = $('#password');
    const togglePw = $('#togglePw');
    const remember = $('#remember');
    const emailBtn = $('#emailSubmit');

    // Helpers
    function showError(msg){
      if (!errBox) return alert(msg);
      errBox.textContent = msg;
      errBox.style.display = 'block';
      errBox.scrollIntoView({ behavior:'smooth', block:'nearest' });
    }
    function clearError(){ if (errBox) errBox.style.display = 'none'; }

    // Toggle password visibility
    togglePw.addEventListener('click', () => {
      const type = pwEl.type === 'password' ? 'text' : 'password';
      pwEl.type = type;
      togglePw.textContent = type === 'password' ? 'Show' : 'Hide';
    });

    // Set persistence based on "Remember me"
    async function applyPersistence() {
      await setPersistence(auth, remember?.checked ? browserLocalPersistence : browserSessionPersistence);
    }

    // Email/password login
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      clearError();

      if (!emailEl.value.trim() || !pwEl.value) {
        showError('Please enter email and password.');
        return;
      }

      const old = emailBtn.innerHTML;
      emailBtn.disabled = true;
      emailBtn.innerHTML = '<span class="fa-solid fa-spinner fa-spin"></span> Signing in...';

      try {
        await applyPersistence();
        await signInWithEmailAndPassword(auth, emailEl.value.trim().toLowerCase(), pwEl.value);
        window.location.replace(AFTER_LOGIN_REDIRECT);
      } catch (err) {
        const map = {
          'auth/invalid-email': 'Please enter a valid email address.',
          'auth/user-disabled': 'This account has been disabled.',
          'auth/user-not-found': 'No account found with that email.',
          'auth/wrong-password': 'Incorrect password. Try again.',
          'auth/too-many-requests': 'Too many attempts. Try again later.',
          'auth/network-request-failed': 'Network error. Check your connection.'
        };
        showError(map[err.code] || err.message || 'Sign-in failed.');
      } finally {
        emailBtn.disabled = false;
        emailBtn.innerHTML = old;
      }
    });

    // OAuth providers
    const providers = {
      google:   new GoogleAuthProvider(),
      facebook: new FacebookAuthProvider(),
      apple:    new OAuthProvider('apple.com'),
    };
    // optional scopes
    providers.facebook.addScope?.('email');

    async function oauth(providerName){
      clearError();
      const provider = providers[providerName];
      if (!provider) return showError('Provider not configured: ' + providerName);

      try {
        await applyPersistence();
        if (providerName === 'apple') {
          // Apple sign-in commonly uses redirect on web
          await signInWithRedirect(auth, provider);
        } else {
          await signInWithPopup(auth, provider);
          window.location.replace(AFTER_LOGIN_REDIRECT);
        }
      } catch (err) {
        const map = {
          'auth/account-exists-with-different-credential': 'An account already exists with the same email using a different sign-in method.',
          'auth/popup-blocked': 'Popup blocked by the browser. Allow popups and try again.',
          'auth/popup-closed-by-user': 'Popup closed before completing sign in.',
          'auth/cancelled-popup-request': 'Popup already open.',
          'auth/network-request-failed': 'Network error. Check your connection.'
        };
        showError(map[err.code] || err.message || 'Could not sign in.');
      }
    }
    // expose to inline onclick handlers
    window.oauth = oauth;
  </script>
</body>
</html>
